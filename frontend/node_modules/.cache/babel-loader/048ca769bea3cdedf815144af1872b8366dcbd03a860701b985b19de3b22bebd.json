{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Container,Row,Col,Button,Spinner,Alert}from\"react-bootstrap\";import PageBreadcrumb from'../../components/breadcrumb/Breadcrumb.comp';import MessageHistory from'../../components/message-history/MessageHistory.comp';import UpdateTicket from'../../components/update-ticket/UpdateTicket.comp';import{useParams}from'react-router-dom';import{useDispatch,useSelector}from'react-redux';import{fetchSingleTicket,closeTicket}from'../ticket-list/ticketsAction';import{resetResponseMsg}from'../ticket-list/ticketsSlice';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Ticket=()=>{const{tid}=useParams();const dispatch=useDispatch();const{isLoading,error,selectedTicket,replyTicketError,replyMsg}=useSelector(state=>state.tickets);// ✅ Safely get ticket data from array\nconst ticket=Array.isArray(selectedTicket)?selectedTicket[0]:selectedTicket;useEffect(()=>{dispatch(fetchSingleTicket(tid));return()=>{(replyMsg||replyTicketError)&&dispatch(resetResponseMsg());};},[tid,dispatch,replyMsg,replyTicketError]);return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(PageBreadcrumb,{page:\"Ticket\"})})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsxs(Col,{children:[isLoading&&/*#__PURE__*/_jsx(Spinner,{variant:\"primary\",animation:\"border\"}),error&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:error}),replyTicketError&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:replyTicketError}),replyMsg&&/*#__PURE__*/_jsx(Alert,{variant:\"success\",children:replyMsg})]})}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{className:\"text-weight-bolder text-secondary\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"subject\",children:[\"Subject: \",ticket===null||ticket===void 0?void 0:ticket.subject]}),/*#__PURE__*/_jsxs(\"div\",{className:\"date\",children:[\"Ticket Opened:\",ticket.openAt&&new Date(ticket.openAt).toLocaleString()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"status\",children:[\"Status: \",ticket===null||ticket===void 0?void 0:ticket.status]})]}),/*#__PURE__*/_jsx(Col,{className:\"text-right\",children:/*#__PURE__*/_jsx(Button,{variant:\"outline-info\",onClick:()=>dispatch(closeTicket(tid)),disabled:(ticket===null||ticket===void 0?void 0:ticket.status)===\"Closed\",children:\"Close Ticket\"})})]}),/*#__PURE__*/_jsx(Row,{className:\"mt-4\",children:/*#__PURE__*/_jsx(Col,{children:(ticket===null||ticket===void 0?void 0:ticket.conversations)&&/*#__PURE__*/_jsx(MessageHistory,{msg:ticket.conversations})})}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(Row,{className:\"mt-4\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(UpdateTicket,{_id:tid})})})]});};export default Ticket;","map":{"version":3,"names":["React","useState","useEffect","Container","Row","Col","Button","Spinner","Alert","PageBreadcrumb","MessageHistory","UpdateTicket","useParams","useDispatch","useSelector","fetchSingleTicket","closeTicket","resetResponseMsg","jsx","_jsx","jsxs","_jsxs","Ticket","tid","dispatch","isLoading","error","selectedTicket","replyTicketError","replyMsg","state","tickets","ticket","Array","isArray","children","page","variant","animation","className","subject","openAt","Date","toLocaleString","status","onClick","disabled","conversations","msg","_id"],"sources":["C:/Users/hp/OneDrive/Documents/Desktop/CRM/crm-frontend/frontend/src/page/ticket/Ticket.page.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Container, Row, Col, Button, Spinner, Alert } from \"react-bootstrap\";\r\nimport PageBreadcrumb from '../../components/breadcrumb/Breadcrumb.comp';\r\nimport MessageHistory from '../../components/message-history/MessageHistory.comp';\r\nimport UpdateTicket from '../../components/update-ticket/UpdateTicket.comp';\r\nimport { useParams } from 'react-router-dom';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { fetchSingleTicket,closeTicket } from '../ticket-list/ticketsAction';\r\nimport { resetResponseMsg } from '../ticket-list/ticketsSlice';\r\n\r\nconst Ticket = () => {\r\n  const { tid } = useParams();\r\n  const dispatch = useDispatch();\r\n\r\n  const {\r\n    isLoading,\r\n    error,\r\n    selectedTicket,replyTicketError,replyMsg\r\n  } = useSelector(state => state.tickets);\r\n\r\n  // ✅ Safely get ticket data from array\r\n  const ticket = Array.isArray(selectedTicket) ? selectedTicket[0] : selectedTicket;\r\n\r\n  useEffect(() => {\r\n    dispatch(fetchSingleTicket(tid));\r\n    return ()=>{\r\n     (replyMsg ||replyTicketError) && dispatch(resetResponseMsg())\r\n    }\r\n  }, [tid, dispatch,replyMsg,replyTicketError]);\r\n\r\n \r\n\r\n  return (\r\n    <Container>\r\n      <Row>\r\n        <Col>\r\n          <PageBreadcrumb page=\"Ticket\" />\r\n        </Col>\r\n      </Row>\r\n\r\n      <Row>\r\n        <Col>\r\n          {isLoading && <Spinner variant=\"primary\" animation=\"border\" />}\r\n          {error && <Alert variant=\"danger\">{error}</Alert>}\r\n          {replyTicketError && <Alert variant=\"danger\">{replyTicketError}</Alert>}\r\n          {replyMsg && <Alert variant='success'>{replyMsg}</Alert>}\r\n        </Col>\r\n      </Row>\r\n\r\n      <Row>\r\n        <Col className=\"text-weight-bolder text-secondary\">\r\n          <div className=\"subject\">Subject: {ticket?.subject}</div>\r\n          <div className=\"date\">\r\n            Ticket Opened:{ticket.openAt && new Date(ticket.openAt).toLocaleString()}\r\n          </div>\r\n          <div className=\"status\">Status: {ticket?.status}</div>\r\n        </Col>\r\n        <Col className=\"text-right\">\r\n          <Button\r\n            variant=\"outline-info\"\r\n            onClick={() => dispatch(closeTicket(tid))}\r\n            disabled={ticket?.status === \"Closed\"}\r\n          >\r\n            Close Ticket\r\n          </Button>\r\n        </Col>\r\n      </Row>\r\n\r\n      <Row className=\"mt-4\">\r\n        <Col>\r\n          {ticket?.conversations && (\r\n            <MessageHistory msg={ticket.conversations} />\r\n          )}\r\n        </Col>\r\n      </Row>\r\n\r\n      <hr />\r\n\r\n      <Row className=\"mt-4\">\r\n        <Col>\r\n          <UpdateTicket _id={tid}/>\r\n        </Col>\r\n      </Row>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Ticket;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}